!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("filofax",[],t):"object"==typeof exports?exports.filofax=t():e.filofax=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(1),a=r(9),s=function(){function e(t){n(this,e),t=t||{},this.lifetime=t.lifetime?t.lifetime:6e4,this.shottime=t.shottime?t.shottime:1e4,this.maxSize=this.lifetime/this.shottime,this.stack=new a({size:this.maxSize,shottime:this.shottime})}return i(e,[{key:"shot",value:function(e){if(this.stack.isNext()&&this.stack.move(),e instanceof Error)var t=o.parse(e);else var t=o.get(e);this.stack.push(t)}},{key:"dump",value:function(){console.log(this.stack.dump())}},{key:"upload",value:function(){}}]),e}();e.exports=s},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r(2),Error.stackTraceLimit=1/0;var o=r(8),a=r(7),s=function(){function e(){n(this,e)}return i(e,null,[{key:"makeToken",value:function(e){return e+":"+performance.now()}},{key:"get",value:function(t){var r=new Error;Error.captureStackTrace(r,arguments.callee);var n=r.callSite.mutated;console.log("get stack length with:",n.length),lastStackFrame=r.lastStackFrame?r.lastStackFrame:a.stackframe,console.log("get lastStackFrame:",lastStackFrame);var i=n[1],s=i.getFunctionName(),u=i.getTypeName();if(t&&"root"===t.type)var c=e.makeToken(u+":"+s),l=null,f=c;else var c=lastStackFrame.rootToken,l=lastStackFrame.token,f=e.makeToken(u+":"+s);var h=i.getFunction(),m=Array.prototype.slice.call(h.arguments,0),p=new o({typeName:i.getTypeName(),functionName:i.getFunctionName(),fileName:i.getFileName(),args:m,lineNumber:i.getLineNumber(),columnNumber:i.getColumnNumber(),isConstructor:i.isConstructor(),isToplevel:i.isToplevel(),rootToken:c,parentToken:l,token:f});return a.stackframe=p,console.log(p.toString()),p}},{key:"parse",value:function(t){var r=/at (?:(.+)\s+\()?(?:(.+?):(\d+):(\d+)|([^)]+))\)?/,n=/([^\.]+)(?:\.(.+))?/,i=t.stack.split("\n"),s=i[0],u=i[1],c=u.match(r);if(c){if(c[1])var l=c[1].match(n),f=l[1],h=l[2];var m=c[2],p=Number(c[3]),v=Number(c[4])}var f=f?f:"",h=h?h:"",m=m?m:"",p=p?p:0,v=v?v:0,y=t.lastStackFrame?t.lastStackFrame:a.stackframe,k=new o({prefix:s,typeName:f,functionName:h,fileName:m,args:[],lineNumber:p,columnNumber:v,rootToken:y.rootToken,parentToken:y.token,token:e.makeToken(f+":"+h)});return console.log(k.toString()),k}}]),e}();e.exports=s},function(e,t,r){function n(e){var t=Error.stackTraceLimit;Error.stackTraceLimit=t+e;var r=u.callSite({extend:!1,filter:!0,slice:e});return Error.stackTraceLimit=t,r}function i(e,t,r){console.log("async init",e);var i=n(2);i.push.apply(i,null===r?h:p.get(r)),i.splice(Error.stackTraceLimit),p.set(e,i),v.set(e,f.stackframe)}function o(e){h=p.get(e),m=v.get(e)}function a(e){h=null,m=null}function s(e){p["delete"](e),v["delete"](e)}var u=r(3),c=r(5),l=new c,f=r(7),h=null,m=null,p=new Map,v=new Map;l.add({init:i,pre:o,post:a,destroy:s}),l.enable(),u.extend.attach(function(e,t){return m&&(e.lastStackFrame=m),t.push.apply(t,h),t})},function(e,t,r){function n(){this.extend=new i,this.filter=new i,this.format=new o}function i(){this._modifiers=[]}function o(){this._formater=u,this._previous=void 0}function a(e,t){if(c)return t;var r=t.concat();return r=l.extend._modify(e,r),r=l.filter._modify(e,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(e)&&void 0===Object.getOwnPropertyDescriptor(e,"callSite")&&(e.callSite={original:t,mutated:r}),l.format._formater(e,r)}function s(){return this.stack,this.callSite}var u=r(4),c=!1;n.prototype.callSite=function f(e){e||(e={}),c=!0;var t={};Error.captureStackTrace(t,f);var r=t.stack;return c=!1,r=r.slice(e.slice||0),e.extend&&(r=this.extend._modify(t,r)),e.filter&&(r=this.filter._modify(t,r)),r};var l=new n;i.prototype._modify=function(e,t){for(var r=0,n=this._modifiers.length;n>r;r++)t=this._modifiers[r](e,t);return t},i.prototype.attach=function(e){this._modifiers.push(e)},i.prototype.deattach=function(e){var t=this._modifiers.indexOf(e);return-1===t?!1:(this._modifiers.splice(t,1),!0)},o.prototype.replace=function(e){e?this._formater=e:this.restore()},o.prototype.restore=function(){this._formater=u},o.prototype._backup=function(){this._formater===u?this._previous=void 0:this._previous=this._formater},o.prototype._roolback=function(){this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&l.format.replace(Error.prepareStackTrace),Object.defineProperty(Error,"prepareStackTrace",{get:function(){return a},set:function(e){e===a?l.format._roolback():(l.format._backup(),l.format.replace(e))}}),Object.defineProperty(Error.prototype,"callSite",{get:s,set:function(e){Object.defineProperty(this,"callSite",{value:e,writable:!0,configurable:!0})},configurable:!0}),e.exports=l},function(e,t){e.exports=function(e,t){var r=[];r.push(e.toString());for(var n=0;n<t.length;n++){var i,o=t[n];try{i=o.toString()}catch(a){try{i="<error: "+a+">"}catch(s){i="<error>"}}r.push("    at "+i)}return r.join("\n")}},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=Symbol("async-hook-uid"),a={timers:r(6)},s=function(){function e(){n(this,e),this.enabled=!1,this.counter=0;var t=this.initFns=[],r=this.preFns=[],i=this.postFns=[],s=this.destroyFns=[];this.init=function(e,r){this[o]=e,null!==r&&(r=r[o]);var n=!0,i=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value;c(e,this,r)}}catch(l){i=!0,a=l}finally{try{!n&&u["return"]&&u["return"]()}finally{if(i)throw a}}},this.pre=function(){var e=this[o],t=!0,n=!1,i=void 0;try{for(var a,s=r[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var u=a.value;u(e,this)}}catch(c){n=!0,i=c}finally{try{!t&&s["return"]&&s["return"]()}finally{if(n)throw i}}},this.post=function(){var e=this[o],t=!0,r=!1,n=void 0;try{for(var a,s=i[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var u=a.value;u(e,this)}}catch(c){r=!0,n=c}finally{try{!t&&s["return"]&&s["return"]()}finally{if(r)throw n}}},this.destroy=function(e){var t=!0,r=!1,n=void 0;try{for(var i,o=s[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a(e)}}catch(u){r=!0,n=u}finally{try{!t&&o["return"]&&o["return"]()}finally{if(r)throw n}}};var u=!0,c=!1,l=void 0;try{for(var f,h=Object.keys(a)[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var m=f.value;a[m].call(this)}}catch(p){c=!0,l=p}finally{try{!u&&h["return"]&&h["return"]()}finally{if(c)throw l}}}return i(e,[{key:"add",value:function(e){e.init&&this.initFns.push(e.init),e.pre&&this.preFns.push(e.pre),e.post&&this.postFns.push(e.post),e.destroy&&this.destroyFns.push(e.destroy)}},{key:"remove",value:function(t){t.init&&e.removeElement(this.initFns,t.init),t.pre&&e.removeElement(this.preFns,t.pre),t.post&&e.removeElement(this.postFns,t.post),t.destroy&&e.removeElement(this.destroyFns,t.destroy)}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}}],[{key:"removeElement",value:function(e,t){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}}]),e}();e.exports=s},function(e,t){function r(){}function n(){}function i(e,t,r,n,i,a,s){var u=o[r],c=o[n];o[r]=function(){if(!t.enabled)return u.apply(o,arguments);var r=Array.from(arguments),n=r[0],c=new i,l=--t.counter,f=void 0;return e.init.call(c,l,null),r[0]=function(){e.pre.call(c),n.apply(this,arguments),e.post.call(c),s&&(a["delete"](f),e.destroy.call(null,l))},f=u.apply(o,r),a.set(f,l),f},o[n]=function(t){if(a.has(t)){var r=a.get(t);a["delete"](t),e.destroy.call(null,r)}c.apply(o,arguments)}}var o=window,a=new Map,s=new Map;e.exports=function(){i(this,this,"setTimeout","clearTimeout",r,a,!0),i(this,this,"setInterval","clearInterval",n,s,!1)}},function(e,t){e.exports={stackframe:null}},function(e,t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),t instanceof Object?(this.prefix=t.prefix?t.prefix+"@":"",this.typeName=t.typeName||"Object",this.functionName=t.functionName||"",this.fileName=t.fileName||"",this.source=t.source||"",this.args=t.args||[],this.lineNumber=e.isNumber(t.lineNumber)?t.lineNumber:0,this.columnNumber=e.isNumber(t.columnNumber)?t.columnNumber:0,this.isConstructor=t.isConstructor,this.isToplevel=t.isToplevel,this.rootToken=t.rootToken||null,this.parentToken=t.parentToken||null,this.token=t.token||null,window.performance?this.time=window.performance.now():this.time=null):console.warn("stackframe arguments must be object!")}return n(e,[{key:"toString",value:function(){var e=this.getTypeName()||"",t=this.getFunctionName()||"{anonymous}",r=this.getArgs().join(","),n=this.getFileName(),i=this.getLineNumber(),o=this.getColumnNumber(),a=this.getRootToken(),s=this.getParentToken(),u=this.getToken();return""+this.prefix+e+"."+t+"("+r+")@"+n+":"+i+":"+o+"@"+a+"-"+s+"-"+u}},{key:"getTypeName",value:function(){return this.typeName}},{key:"getFunctionName",value:function(){return this.functionName}},{key:"getFileName",value:function(){return this.fileName}},{key:"getSource",value:function(){return this.source}},{key:"getArgs",value:function(){return this.args}},{key:"getLineNumber",value:function(){return this.lineNumber}},{key:"getColumnNumber",value:function(){return this.columnNumber}},{key:"isToplevel",value:function(){return this.isToplevel}},{key:"isConstructor",value:function(){return this.isConstructor}},{key:"getRootToken",value:function(){return this.rootToken}},{key:"getParentToken",value:function(){return this.parentToken}},{key:"getToken",value:function(){return this.token}}],[{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}}]),e}();e.exports=i},function(e,t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),this.size=t.size?t.size:10,this.shottime=t.shottime?t.shottime:1e4,this.cursor=0,this.nextCursorTime=this.shottime,this.data=[];for(var n=0,i=this.size-1;i>=n;n++)this.data[n]={}}return n(e,[{key:"isNext",value:function(){return performance.now()>this.nextCursorTime}},{key:"move",value:function(){var e=this.data.length-1;this.cursor<e?this.cursor++:(this.cursor=e)&&(this.cursor=0),this.nextCursorTime=performance.now()+this.shottime,console.log("[CycleList move]:",this.cursor,this.nextCursorTime),this.clean()}},{key:"push",value:function(e){console.log("[CycleList push]:",this.cursor);var t=this.data[this.cursor],r=e.rootToken,n=Object.keys(t);-1===n.indexOf(r)&&(t[r]=[]),t[r].push(e.toString())}},{key:"clean",value:function(){console.log("[CycleList clean:]",this.cursor),this.data[this.cursor]={}}},{key:"dump",value:function(){return this.data}}]),e}();e.exports=i}])});
//# sourceMappingURL=filofax.min.js.map